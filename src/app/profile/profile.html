<div class="container py-4">
  <h2 class="mb-4">My Profile</h2>

  @if (loadingProfile) {
    <div class="text-center py-5">
      <div class="spinner-border" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
  } @else {
    @if (error) {
      <div class="alert alert-danger">{{ error }}</div>
    }

    @if (successMessage) {
      <div class="alert alert-success">{{ successMessage }}</div>
    }

    @if (profile) {
      <div class="row g-4">
        <div class="col-lg-7">
          <div class="card p-4 mb-4">
            <h4 class="mb-3">Profile Information</h4>

            @if (profile.role !== 'employer') {
              <div class="row">
                <div class="col-md-6 mb-3">
                  <label class="form-label">First Name</label>
                  <input type="text" class="form-control" [(ngModel)]="firstName" [disabled]="savingProfile">
                </div>
                <div class="col-md-6 mb-3">
                  <label class="form-label">Last Name</label>
                  <input type="text" class="form-control" [(ngModel)]="lastName" [disabled]="savingProfile">
                </div>
              </div>
            }

            @if (profile.role === 'employer') {
              <div class="mb-3">
                <label class="form-label">Company</label>
                <input type="text" class="form-control" [(ngModel)]="company" [disabled]="savingProfile">
              </div>
            }

            @if (profile.role !== 'employer') {
              <div class="mb-3">
                <label class="form-label">Headline</label>
                <input 
                  type="text" 
                  class="form-control" 
                  placeholder="e.g. Senior Frontend Developer, Hiring Manager at TechCorp"
                  [(ngModel)]="headline"
                  [disabled]="savingProfile"
                >
              </div>
            }

            <div class="mb-3">
              <label class="form-label">Bio / About</label>
              <textarea 
                class="form-control" 
                rows="4" 
                placeholder="Tell others a bit about yourself."
                [(ngModel)]="bio"
                [disabled]="savingProfile"
              ></textarea>
            </div>

            <div class="row">
              <div class="col-md-6 mb-3">
                <label class="form-label">Location</label>
                <input type="text" class="form-control" [(ngModel)]="location" [disabled]="savingProfile">
              </div>
              <div class="col-md-6 mb-3">
                <label class="form-label">Phone</label>
                <input type="tel" class="form-control" [(ngModel)]="phone" [disabled]="savingProfile">
              </div>
            </div>

            <div class="mb-3">
              <label class="form-label">Website / Portfolio</label>
              <input type="url" class="form-control" [(ngModel)]="website" [disabled]="savingProfile">
            </div>

            <button 
              class="btn btn-primary"
              (click)="saveProfile()"
              [disabled]="savingProfile"
            >
              {{ savingProfile ? 'Saving...' : 'Save Profile' }}
            </button>
          </div>
        </div>

        <div class="col-lg-5">
          <div class="card p-4 mb-4">
            <h4 class="mb-3">Account Settings</h4>

            <div class="mb-3">
              <label class="form-label">Email</label>
              <input 
                type="email" 
                class="form-control" 
                [(ngModel)]="email"
                [disabled]="savingAccount"
              >
              <small class="text-muted">
                Changing your email updates the email used to log in.
              </small>
            </div>

            <hr class="my-4">

            <div class="mb-3">
              <label class="form-label">New Password</label>
              <input 
                type="password" 
                class="form-control" 
                [(ngModel)]="newPassword"
                [disabled]="savingAccount"
              >
            </div>

            <div class="mb-3">
              <label class="form-label">Confirm New Password</label>
              <input 
                type="password" 
                class="form-control" 
                [(ngModel)]="confirmPassword"
                [disabled]="savingAccount"
              >
            </div>

            <button 
              class="btn btn-outline-primary w-100"
              (click)="saveAccountSettings()"
              [disabled]="savingAccount"
            >
              {{ savingAccount ? 'Saving...' : 'Update Account Settings' }}
            </button>

            <p class="text-muted small mt-3">
              For security reasons, you may be asked to log in again after changing sensitive information.
            </p>
          </div>
        </div>
      </div>
    }
  }
</div>


